# Internationalization (i18n) Support

## Overview
The Gemini Mail Review add-on now supports internationalization, automatically displaying the UI in the language matching Thunderbird's language settings.

## Supported Languages
- **English (en)** - Default language
- **Japanese (ja)** - 日本語対応

## Features
- Automatic language detection based on Thunderbird's locale
- Fallback to English if the current locale is not supported
- All UI elements are translated including:
  - Extension name and description
  - Options page (settings)
  - Popup interface (email review)
  - Buttons, labels, and messages
  - Error messages and status text

## Implementation Details

### Directory Structure
```
_locales/
├── en/
│   └── messages.json    # English translations
└── ja/
    └── messages.json    # Japanese translations
```

### How It Works
1. The add-on uses the WebExtension `browser.i18n` API
2. Thunderbird automatically detects its current locale setting
3. The add-on loads the corresponding `messages.json` file
4. All UI text is replaced with localized strings at runtime
5. If a locale is not supported, English is used as the default

### Example Translations

#### Extension Name
- English: "Gemini Mail Review"
- Japanese: "Gemini メールレビュー"

#### Options Page Title
- English: "Gemini Mail Review Settings"
- Japanese: "Gemini メールレビュー 設定"

#### Save Button
- English: "Save Settings"
- Japanese: "設定を保存"

#### Error Messages
- English: "Please configure your Gemini API key in the settings."
- Japanese: "設定で Gemini API キーを設定してください。"

#### Custom Prompt Templates
- English: "Custom Prompt Templates:"
- Japanese: "カスタムプロンプトテンプレート:"

#### Template Selection
- English: "Select Custom Prompt Template:"
- Japanese: "カスタムプロンプトテンプレートを選択:"

#### Template Names
- English: "Template 1 Name:", "Template 2 Name:", "Template 3 Name:"
- Japanese: "テンプレート1の名前:", "テンプレート2の名前:", "テンプレート3の名前:"

## How to Test

### Changing Thunderbird's Language
1. Open Thunderbird
2. Go to **Settings** > **General** > **Language**
3. Select your preferred language (English or Japanese)
4. Restart Thunderbird
5. Open the add-on options or popup - it will display in the selected language

### Verifying Language Support
1. Install the add-on in Thunderbird
2. Test with English locale:
   - Set Thunderbird language to English
   - Restart Thunderbird
   - Open add-on settings - should display in English
3. Test with Japanese locale:
   - Set Thunderbird language to Japanese (日本語)
   - Restart Thunderbird
   - Open add-on settings - should display in Japanese

## Adding New Languages

To add support for additional languages:

1. Create a new locale directory:
   ```bash
   mkdir -p _locales/{locale_code}/
   ```

2. Copy the English messages file as a template:
   ```bash
   cp _locales/en/messages.json _locales/{locale_code}/messages.json
   ```

3. Translate all message values in the new `messages.json` file:
   ```json
   {
     "extensionName": {
       "message": "Your Translation Here",
       "description": "Name of the extension"
     },
     ...
   }
   ```

4. Test by setting Thunderbird to the new locale

### Example: Adding French Support
```bash
mkdir -p _locales/fr/
cp _locales/en/messages.json _locales/fr/messages.json
# Edit _locales/fr/messages.json and translate all "message" values to French
```

## Technical Details

### API Used
- `browser.i18n.getMessage(messageName)` - Get localized string
- `browser.i18n.getUILanguage()` - Get current locale (optional)

### Files Modified
- `manifest.json` - Added `default_locale` and i18n placeholders
- `options.html` - Added `data-i18n` attributes to text elements
- `options.js` - Added `localizeUI()` function to load localized strings
- `popup.html` - Added `data-i18n` attributes to text elements
- `popup.js` - Added `localizeUI()` function to load localized strings

### Localization Process
1. Page loads, HTML contains English text as fallback
2. `localizeUI()` function is called on `DOMContentLoaded`
3. Function queries all elements with `data-i18n` attributes
4. For each element, gets the localized message using `browser.i18n.getMessage()`
5. Updates element's `textContent` or `placeholder` with localized string

## Browser Compatibility
- Thunderbird 102.0 and later (full support)
- All modern WebExtension-compatible browsers (if ported)

## Notes
- The i18n implementation follows Mozilla's WebExtension standards
- All strings are stored in JSON format for easy maintenance
- The system is extensible - new languages can be added without code changes
- Fallback ensures the add-on always works, even with unsupported locales
